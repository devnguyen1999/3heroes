CREATE DATABASE 3heroes;
USE 3heroes;
CREATE TABLE tbl_apkinfo (
	md5 VARCHAR(175) NOT NULL,
	appName VARCHAR(50) NULL,
	fileSize INT NULL,
	sha1 VARCHAR(200) NOT NULL UNIQUE,
	sha256 VARCHAR(225) NOT NULL UNIQUE,
	sha512 VARCHAR(250) NOT NULL UNIQUE,
	firstSubmission DATETIME NULL,
	lastSubmission DATETIME NULL,
	package VARCHAR(50) NULL,
	androidversionCode VARCHAR(50) NULL,
	androidversionName VARCHAR(50) NULL,
	minSDKVersion TINYINT NULL,
	maxSDKVersion TINYINT NULL,
	targetSDKVersion TINYINT NULL,
	mainActivity VARCHAR(50) NULL,
	PRIMARY KEY (md5)
);

DELIMITER //
CREATE DEFINER=root@localhost PROCEDURE addApkInfo(
	IN md5 VARCHAR(175),
	IN appName VARCHAR(50),
	IN fileSize INT,
	IN sha1 VARCHAR(200),
	IN sha256 VARCHAR(225),
	IN sha512 VARCHAR(250),
	IN firstSubmission DATETIME,
	IN lastSubmission DATETIME,
	IN package VARCHAR(50),
	IN androidversionCode VARCHAR(50),
	IN androidversionName VARCHAR(50),
	IN minSDKVersion TINYINT,
	IN maxSDKVersion TINYINT,
	IN targetSDKVersion TINYINT,
	IN mainActivity VARCHAR(50)
)
BEGIN
    IF ( SELECT EXISTS (SELECT * FROM tbl_apkinfo WHERE md5 = md5) ) THEN
     
        SELECT 'File already exists!';
     
    ELSE
     
        INSERT INTO tbl_apkinfo
        (
			md5,
			appName,
			fileSize,
			sha1,
			sha256,
			sha512,
			firstSubmission,
			lastSubmission,
			package,
			androidversionCode,
			androidversionName,
			minSDKVersion,
			maxSDKVersion,
			targetSDKVersion,
			mainActivity
        )
        VALUES
        (
			md5,
			appName,
			fileSize,
			sha1,
			sha256,
			sha512,
			firstSubmission,
			lastSubmission,
			package,
			androidversionCode,
			androidversionName,
			minSDKVersion,
			maxSDKVersion,
			targetSDKVersion,
			mainActivity
        );
     
    END IF;
END //
DELIMITER ;